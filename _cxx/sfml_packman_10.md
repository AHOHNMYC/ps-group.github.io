---
title: 'Персонализация призраков'
---

Каждый призрак в игре пакман &mdash; личность, и в данном примере мы покажем и реализуем эту особенность.

## Целевые клетки

Каждое приведение постоянно следует в какую-то клетку. Для понимания этой концепции обратимся к [статье о поведении призраков в Pac-Man](https://habrahabr.ru/post/109406/)

> Ключом понимания алгоритма привидений является концепция «целевой клетки». Подавляющее большинство времени у каждого призрака есть клетка, которую он пытается достичь, и его поведение как раз и состоит из того, чтобы добраться от своего положения до целевой клетки. Каждый призрак использует один и тот же алгоритм перемещения к целевой клетке, однако их индивидуальность состоит в том, что целевые клетки каждого из них отличаются. Обратите внимание, что нет никаких ограничений, что целевая клетка должна быть доступна для перемещения туда (даже чаще всего она как раз недоступна). Многие аспекты поведения призраков являются прямым результатом этой особенности. Клетки будут еще затронуты далее, а пока просто имейте в виду, что призраки почти всегда мотивировано пытаются достичь своей целевой клетки.

Целевая клетка призрака может меняться в процессе игры, в том числе это зависит от режима, в котором находится призрак. Режим можно задать следующим перечислением:

```cpp
enum struct GhostBehavior
{
    // режим разбегания: призрак имеет фиксированную
    //  целевую клетку вблизи угла карты.
    Scatter,
    // режим страха: призраки не имеют целевой клетки,
    //  и выбирают направление движения на каждом перекрестке
    Frightened,
    // режим погони: Blinky преследует клетку,
    //  в которой сейчас находится Pac-Man
    Chase,
}
```

Режим страха включается, когда Pac-Man съедает суперпеченье и может уничтожить призраков. Остальные два режима введены для того, чтобы игрок не ощущал постоянного преследования &mdash; вместо этого призраки нападают волнами, и после каждой волны согласованно отступают.

## Смена погони и разбегания

## Что потребуется знать призраку

Чтобы принимать решение о выборе направления движения, призрак должен получать актуальную информацию о состоянии игры, а именно:

- позицию игрока
- позицию остальных призраков (например, поведение Inky зависит от местоположения Blinky)
- количество съеденного и оставшегося печенья (например, Inky выходит из домика приведений только тогда, когда съедено не менее 30 печений)
- интервалы времени
